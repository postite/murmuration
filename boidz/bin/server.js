// Generated by Haxe 3.3.0
if (process.version < "v4.0.0") console.warn("Module " + (typeof(module) == "undefined" ? "" : module.filename) + " requires node.js version 4.0.0 or higher");
(function () { "use strict";
var Config = function() { };
var haxe_io_Bytes = function() { };
var js_node_Http = require("http");
var js_node_buffer_Buffer = require("buffer").Buffer;
var js_npm_Express = require("express");
var js_npm_express_Static = require("express").static;
var js_npm_socketio_Server = require("socket.io");
var socket_Server = function() {
	this.PORT = 3700;
	console.log("Express website (Basic): open browser at " + Config.adress + this.PORT);
	console.log("Stop node.js : CTRL + c");
	var app = new js_npm_Express();
	var server = js_node_Http.createServer(app);
	var io = new js_npm_socketio_Server(server);
	app.set("views",__dirname + "/views/");
	app.set("view engine","jade");
	app["use"](new js_npm_express_Static(__dirname + "/"));
	app.get("/client/:id",function(req,res) {
		res.render("page",{ bip : "bop", client : req});
	});
	app.get("/remote",function(req1,res1) {
		res1.render("rem",{ bip : "remote"});
	});
	app.get("/rasp1",function(req2,res2) {
		res2.render("rasp1",{ bip : "rasp"});
	});
	io.on("connection",function(socket1) {
		socket_Server.numClient = (socket_Server.numClient + 1) % 2;
		socket1.emit("clientConnect",{ clients : socket_Server.numClient});
		socket1.on("send",function(light) {
			io.sockets.emit("message",light);
		});
		socket1.on("ctrl",function(arg) {
			io.sockets.emit("control",arg);
		});
		socket1.on("walk",function(arg1) {
			io.sockets.emit("walking",arg1);
		});
	});
	io.on("disconnect",function(socket2) {
		socket_Server.numClient = socket_Server.numClient - 2;
		console.log("disconnect");
	});
	console.log("Listening on port " + this.PORT);
	server.listen(this.PORT);
};
socket_Server.main = function() {
	new socket_Server();
};
Config.adress = "http://localhost:3700";
socket_Server.numClient = 0;
socket_Server.main();
})();
